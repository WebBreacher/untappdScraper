{"version":3,"file":"static/webpack/static/development/pages/index.js.6901af9db7dea3e93049.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React, { Component } from 'react'\nimport { Tooltip } from 'react-tippy'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faQuestionCircle } from '@fortawesome/free-solid-svg-icons'\nimport LoadingIcon from './../assets/logos/single-glass.png'\nimport logoImg from './../assets/logos/logo-untapped.png'\nimport { getUntappdOsint, loadGoogleMapsClient, formatHour } from '../lib/utils'\nimport Table from './../components/Table'\nimport Chart from './../components/Chart'\nconst timeFormat = 'DD MMM YY HH:mm:ss Z'\n\nconst getHourPriority = (numString) => {\n  const num = parseInt(numString, 10)\n\n  let priority = num - 7\n\n  if (priority < 0) {\n    priority = 24 + priority\n  }\n\n  return priority\n}\n\nconst sortHourEntries = (a, b) => {\n  // Sort from 07:00 to 06:00.\n  const aPriority = getHourPriority(a[0])\n  const bPriority = getHourPriority(b[0])\n\n  if (aPriority < bPriority) {\n    return -1\n  }\n\n  if (aPriority > bPriority) {\n    return 1\n  }\n\n  return 0\n}\n\nconst makeChartData = (initialData, sortFn, formatX) => {\n  let entries = Object.entries(initialData)\n\n  if (sortFn) {\n    entries = entries.sort(sortFn)\n  }\n\n  return entries.reduce((acc, cur) => {\n    let [x, y] = cur\n\n    if (formatX) {\n      x = formatX(x)\n    }\n\n    return [...acc, { x, y }]\n  }, [])\n}\n\nexport default class Index extends Component {\n  constructor () {\n    super()\n\n    this.state = {\n      username: '',\n      recentActivityOnly: false,\n      googleMapsApiKey: '',\n      googleMapsClient: null,\n      loadingGoogleMapsClient: false,\n      data: null,\n      error: null,\n      submitting: false,\n      loading: false\n    }\n  }\n\n  updateUsername (e) {\n    this.setState({\n      username: e.target.value\n    })\n  }\n\n  updateRecentActivityOnly () {\n    this.setState({\n      recentActivityOnly: !this.state.recentActivityOnly\n    })\n  }\n\n  updateGoogleMapsApiKey (e) {\n    this.setState({\n      googleMapsApiKey: e.target.value\n    })\n  }\n\n  async getUntappdOsint (e) {\n    e.preventDefault()\n\n    this.setState({\n      data: null,\n      error: null,\n      submitting: true,\n      loading: true\n    })\n\n    const username = this.state.username.trim()\n    const recentActivityOnly = this.state.recentActivityOnly\n    const googleMapsClient = this.state.googleMapsClient\n\n    if (username) {\n      try {\n        const data = await getUntappdOsint(username, recentActivityOnly, googleMapsClient)\n\n        this.setState({\n          data,\n          username: '',\n          submitting: false,\n          loading: false\n        })\n      } catch (err) {\n        this.setState({\n          error: err.toString(),\n          submitting: false,\n          loading: false\n        })\n      }\n    } else {\n      this.setState({\n        error: 'Must provide a username.',\n        submitting: false,\n        loading: false\n      })\n    }\n  }\n\n  async setupGoogleMapsClient (e) {\n    e.preventDefault()\n\n    this.setState({\n      loadingGoogleMapsClient: true,\n      submitting: true\n    })\n\n    const googleMapsApiKey = (this.state.googleMapsApiKey) ? this.state.googleMapsApiKey.trim() : undefined\n\n    if (googleMapsApiKey) {\n      try {\n        await loadGoogleMapsClient(googleMapsApiKey)\n\n        this.setState({\n          // eslint-disable-next-line no-undef\n          googleMapsClient: google,\n          loadingGoogleMapsClient: false,\n          submitting: false\n        })\n      } catch (err) {\n        this.setState({\n          error: err.toString(),\n          loadingGoogleMapsClient: false,\n          submitting: false\n        })\n      }\n    } else {\n      this.setState({\n        error: 'Must provide a Google Maps API key.',\n        loadingGoogleMapsClient: false\n      })\n    }\n  }\n\n  render () {\n    const googleAPITooltip = 'Optionally, you can provide a valid Google Maps API key, which will enable the application to analyze the locations it finds. This key is never sent to any server other than the Google Maps API.<br/><br/>This might silently fail if the API key provided is invalid or for an account that does not have the Maps JavaScript API and Geocoding APIs enabled. Check the developer console if the Maps functionality does not work correctly after setting the API key.'\n    return (\n      <div className=\"container\">\n        <menu className=\"navbar-menu\">\n          <img id=\"logo-img\" src={logoImg}/>\n\n          <div id=\"user-form\">\n            <form onSubmit={e => { this.getUntappdOsint(e) }} disabled={this.state.submitting}>\n              <input className=\"text-input\" placeholder=\"Username\" type=\"text\" value={this.state.username} onChange={e => this.updateUsername(e) } />\n              <label>Recent Activity <strong>only</strong></label>\n              <input type=\"checkbox\" value={this.state.recentActivityOnly} onChange={e => { this.updateRecentActivityOnly(e) }} />\n              <input className=\"button\" type=\"submit\" value=\"Scrape\" disabled={this.state.submitting} />\n            </form>\n          </div>\n\n          <div id=\"maps-api-form\">\n            <form onSubmit={e => { this.setupGoogleMapsClient(e) }}>\n              <input className=\"text-input\" placeholder=\"Google Maps API Key\" type=\"password\" value={this.state.googleMapsApiKey} onChange={e => { this.updateGoogleMapsApiKey(e) }} readOnly={this.state.googleMapsClient} />\n\n              <Tooltip title={googleAPITooltip} position=\"bottom\" trigger=\"click\">\n                <FontAwesomeIcon icon={faQuestionCircle}/>\n              </Tooltip>\n\n              <input className=\"button\" type=\"submit\" value=\"Set\" disabled={this.state.loadingGoogleMapsClient || this.state.googleMapsClient} />\n            </form>\n          </div>\n        </menu>\n\n        <main className=\"content\">\n          {this.state.error &&\n            <strong>{this.state.error}</strong>\n          }\n\n          {this.state.loading &&\n            <div><img className=\"loading-beer\" src={LoadingIcon} alt=\"loadingIcon\"/>\n              <span>Scraping...</span></div>\n          }\n\n          {this.state.data && this.state.data.stats &&\n            <Table title={`User Stats for ${this.state.data.username}`} data={[{ ...this.state.data.stats }]}/>\n          }\n\n          {this.state.data && this.state.data.recentActivity &&\n            <Table title=\"Recent Activity\" data={this.state.data.recentActivity} valueFormatter={params => {\n              if (params.column.colId === 'time') {\n                return params.value.format(timeFormat)\n              }\n            }} />\n          }\n\n          {this.state.data && this.state.data.venues &&\n            <Table title=\"Venues: \" data={this.state.data.venues} valueFormatter={params => {\n              const venue = params.data\n              const columnName = params.column.colId\n\n              if (columnName === 'geocode') {\n                return `${venue.geocode[0].geometry.location.lat()}, ${venue.geocode[0].geometry.location.lng()}`\n              }\n\n              return params.value\n            }} />\n          }\n\n          {this.state.data && this.state.data.beers &&\n            <Table title=\"Beers:\" data={this.state.data.beers} valueFormatter={params => {\n              const columnName = params.column.colId\n\n              if (columnName === 'firstDrinkTime') {\n                return params.value.format(timeFormat)\n              }\n\n              if (columnName === 'lastDrinkTime') {\n                return params.value.format(timeFormat)\n              }\n\n              return params.value\n            }} />\n          }\n\n          <div style={{ height: (this.state.data && this.state.data.map) ? '400px' : 0 }}>\n            <div id=\"map\"></div>\n          </div>\n\n          {this.state.data && this.state.data.beerAnalytics &&\n            <div>\n              {this.state.data && this.state.data.beerAnalytics.dayOfWeek &&\n                <Chart headerTitle=\"Drinking Patterns (Last 25 beers) - Day of Week:\" data={makeChartData(this.state.data.beerAnalytics.dayOfWeek)} />\n              }\n\n              {this.state.data && this.state.data.beerAnalytics.hourOfDay &&\n                <Chart headerTitle=\"Drinking Patterns (Last 25 beers) - Hour of Day:\" data={makeChartData(this.state.data.beerAnalytics.hourOfDay, sortHourEntries, formatHour)}/>\n              }\n\n              {this.state.data && this.state.data.beerAnalytics.dayOfMonth &&\n                <Chart headerTitle=\"Drinking Patterns (Last 25 beers) - Day of Month:\" data={makeChartData(this.state.data.beerAnalytics.dayOfMonth)}/>\n              }\n\n              {this.state.data && this.state.data.beerAnalytics.binges &&\n                <div className=\"binges-table\">\n                  <header>\n                    <h3>Binge Drink Periods (5+ drinks for men / 4+ drinks for women in &lt; 2 hours*):</h3>\n                  </header>\n\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Start Time</th>\n                        <th>End Time</th>\n                        <th>Total Drinks</th>\n                      </tr>\n                    </thead>\n\n                    <tbody>\n                      {this.state.data.beerAnalytics.binges.map((binge, index) =>\n                        <tr key={index}>\n                          <td>{binge[0].format(timeFormat)}</td>\n                          <td>{binge[binge.length - 1].format(timeFormat)}</td>\n                          <td>{binge.length}</td>\n                        </tr>\n                      )}\n                    </tbody>\n                  </table>\n                </div>\n              }\n\n              {this.state.data && this.state.data.beerAnalytics.heavyUses &&\n                <div className=\"heavy-uses-table\">\n                  <header>\n                    <h3>Heavy Alcohol Uses (5+ instances of binge drinking in the past month):</h3>\n                  </header>\n\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Start Time</th>\n                        <th>End Time</th>\n                        <th>Total Binges</th>\n                      </tr>\n                    </thead>\n\n                    <tbody>\n                      {this.state.data.beerAnalytics.heavyUses.map((heavyUse, index) =>\n                        <tr key={index}>\n                          <td>{heavyUse[0][0].format(timeFormat)}</td>\n                          <td>{heavyUse[heavyUse.length - 1][heavyUse[heavyUse.length - 1].length - 1].format(timeFormat)}</td>\n                          <td>{heavyUse.length}</td>\n                        </tr>\n                      )}\n                    </tbody>\n                  </table>\n                </div>\n              }\n\n              {this.state.data && (this.state.data.beerAnalytics.binges || this.state.data.beerAnalytics.heavyUses) &&\n                <p>\n                  *<a href=\"https://www.niaaa.nih.gov/alcohol-health/overview-alcohol-consumption/moderate-binge-drinking\"><em>Drinking Levels Definitions from the NIAAA</em></a>\n                </p>\n              }\n            </div>\n          }\n        </main>\n      </div>\n    )\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAHA;AAcA;AACA;;;AACA;AACA;AACA;AADA;AAGA;;;AAEA;AACA;AACA;AADA;AAGA;;;AAEA;AACA;AACA;AADA;AAGA;;;AAEA;;;;;;AACA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AACA;;;;;;;AAEA;AACA;;AADA;AAEA;AACA;AACA;AACA;AACA;AAJA;;;;;;;AAOA;AACA;AACA;AACA;AAHA;AACA;;;;;;AAMA;AACA;AACA;AACA;AAHA;AACA;;;;;;;;;;AAOA;;;;;;AACA;AAEA;AACA;AACA;AAFA;AAKA;AACA;AACA;;;;;;;AAEA;AACA;;AACA;AACA;AACA;AACA;AACA;AAJA;;;;;;;AAOA;AACA;AACA;AACA;AAHA;AACA;;;;;;AAMA;AACA;AACA;AAFA;AACA;;;;;;;;;;AAMA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AAaA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;;;;AAlRA;AACA;;;;;A","sourceRoot":""}